<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lazar Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #F8FAFC;
      color: #0F172A;
      overflow: hidden; /* App handles scrolling */
    }
    /* Custom Scrollbar */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }
    ::-webkit-scrollbar-track {
      background: transparent;
    }
    ::-webkit-scrollbar-thumb {
      background: #CBD5E1;
      border-radius: 3px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: #94A3B8;
    }
    
    /* Animations */
    @keyframes fade-in-up {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .animate-fade-in-up {
      animation: fade-in-up 0.5s ease-out forwards;
    }
    @keyframes slide-in-right {
      from { transform: translateX(100%); }
      to { transform: translateX(0); }
    }
    .animate-slide-in-right {
      animation: slide-in-right 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    }
    .animate-spin-slow {
      animation: spin 3s linear infinite;
    }
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    /* Utility */
    .custom-scrollbar {
      overflow-y: auto;
    }
  </style>
<script type="importmap">
{
  "imports": {
    "rxjs": "https://esm.sh/rxjs@^7.8.2?conditions=es2015",
    "rxjs/operators": "https://esm.sh/rxjs@^7.8.2/operators?conditions=es2015",
    "rxjs/ajax": "https://esm.sh/rxjs@^7.8.2/ajax?conditions=es2015",
    "rxjs/webSocket": "https://esm.sh/rxjs@^7.8.2/webSocket?conditions=es2015",
    "rxjs/testing": "https://esm.sh/rxjs@^7.8.2/testing?conditions=es2015",
    "rxjs/fetch": "https://esm.sh/rxjs@^7.8.2/fetch?conditions=es2015",
    "@angular/core": "https://esm.sh/@angular/core@^21.1.4?external=rxjs",
    "@angular/compiler": "https://esm.sh/@angular/compiler@^21.1.4?external=rxjs",
    "@angular/common": "https://esm.sh/@angular/common@^21.1.4?external=rxjs",
    "@angular/platform-browser": "https://esm.sh/@angular/platform-browser@^21.1.4?external=rxjs"
  }
}
</script>
</head>
<body class="flex h-screen w-full">

  <div id="app" class="flex w-full h-full">
    <!-- Content injected by JS -->
  </div>

<script>
  // --- ICON DATA ---
  const icons = {
    sidebar: "M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5", 
    dashboard: "M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25", 
    orders: "M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25zM6.75 12h.008v.008H6.75V12zm0 3h.008v.008H6.75V15zm0 3h.008v.008H6.75V18z",
    quotes: "M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z",
    customers: "M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z",
    vendors: "M13.5 21v-7.5a.75.75 0 01.75-.75h3a.75.75 0 01.75.75V21m-4.5 0H2.36m11.14 0H18m0 0h3.64m-1.39 0V9.349m-16.5 11.65V9.35m0 0a3.001 3.001 0 003.75-.615A2.993 2.993 0 009.75 9.75c.896 0 1.7-.393 2.25-1.016a2.993 2.993 0 002.25 1.016c.896 0 1.7-.393 2.25-1.016a3.001 3.001 0 003.75.614m-16.5 0a3.004 3.004 0 01-.621-4.72L4.318 3.44A1.5 1.5 0 015.378 3h13.243a1.5 1.5 0 011.06.44l1.19 1.189a3 3 0 01-.621 4.72m-13.5 8.65h3.75a.75.75 0 00.75-.75V13.5a.75.75 0 00-.75-.75H6.75a.75.75 0 00-.75.75v3.75c0 .415.336.75.75.75z",
    parts: "M11.42 15.17L17.25 21A2.652 2.652 0 0021 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 11-3.586-3.586l6.837-5.63m5.108-.233c.55-.164 1.163-.188 1.743-.14a4.5 4.5 0 004.486-6.336l-3.276 3.277a3.004 3.004 0 01-2.25-2.25l3.276-3.276a4.5 4.5 0 00-6.336 4.486c.091 1.076-.071 2.264-.904 2.95l-.102.085m-1.745 1.437L5.909 7.5H4.5L2.25 3.75l1.5-1.5L7.5 4.5v1.409l4.26 4.26m-1.745 1.437l1.745-1.437m6.615 8.206L15.75 15.75M4.867 19.125h.008v.008h-.008v-.008z",
    machines: "M21 7.5l-9-5.25L3 7.5m18 0l-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9",
    media: "M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z",
    drawings: "M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125",
    chevronRight: "M8.25 4.5l7.5 7.5-7.5 7.5",
    chevronDown: "M19.5 8.25l-7.5 7.5-7.5-7.5",
    chevronUpDown: "M8.25 15L12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9",
    plus: "M12 4.5v15m7.5-7.5h-15",
    check: "M4.5 12.75l6 6 9-13.5",
    search: "M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z",
    bell: "M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0",
    sun: "M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z",
    more: "M6.75 12a.75.75 0 11-1.5 0 .75.75 0 011.5 0zM12.75 12a.75.75 0 11-1.5 0 .75.75 0 011.5 0zM18.75 12a.75.75 0 11-1.5 0 .75.75 0 011.5 0z",
    moreVertical: "M12 6.75a.75.75 0 110-1.5.75.75 0 010 1.5zM12 12.75a.75.75 0 110-1.5.75.75 0 010 1.5zM12 18.75a.75.75 0 110-1.5.75.75 0 010 1.5z",
    filter: "M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 01-.659 1.591l-5.432 5.432a2.25 2.25 0 00-.659 1.591v2.927a2.25 2.25 0 01-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 00-.659-1.591L3.659 7.409A2.25 2.25 0 013 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0112 3z",
    box: "M21 7.5l-9-5.25L3 7.5m18 0l-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9",
    trendingUp: "M2.25 18L9 11.25l4.306 4.307a11.95 11.95 0 015.814-5.519l2.74-1.22m0 0l-5.94-2.28m5.94 2.28l-2.28 5.941",
    trendingDown: "M2.25 6L9 12.75l4.286-4.286a11.948 11.948 0 0111.818 10.27"
  };

  // --- APP STATE ---
  const state = {
    view: 'orders',
    sidebarCollapsed: true, // Collapsed by default as requested
    searchOpen: false,
    breadcrumbOpen: false,
    filterDrawerOpen: false,
    activeOrdersTab: 'Pending',
  };

  // --- DATA ---
  const menuGroups = [
    { title: null, items: [{ label: 'Dashboard', icon: 'dashboard', id: 'dashboard' }] },
    { title: 'Commercial', items: [
      { label: 'Orders', icon: 'orders', id: 'orders' },
      { label: 'Quotes', icon: 'quotes', id: 'quotes' },
      { label: 'Customers', icon: 'customers', id: 'customers' },
      { label: 'Vendors', icon: 'vendors', id: 'vendors' }
    ]},
    { title: 'Inventory', items: [
      { label: 'Parts', icon: 'parts', id: 'parts' },
      { label: 'Machines', icon: 'machines', id: 'machines' }
    ]},
    { title: 'Assets', items: [
      { label: 'Media', icon: 'media', id: 'media' },
      { label: 'Drawings', icon: 'drawings', id: 'drawings' }
    ]}
  ];

  const ordersData = [
    { id: '1', name: 'Guillermo Rauch', company: 'Vercel', status: 'ACTIVE', source: 'Website', lastActivity: '30m ago' },
    { id: '2', name: 'Lee Robinson', company: 'Vercel', status: 'ACTIVE', source: 'Referral', lastActivity: '2h ago' },
    { id: '3', name: 'Sam Altman', company: 'OpenAI', status: 'LEAD', source: 'Social Media', lastActivity: '4h ago' },
    { id: '4', name: 'Michael Andreuzza', company: 'Lexington', status: 'CONTACTED', source: 'Conference', lastActivity: '5h ago' },
    { id: '5', name: 'Skyleen', company: 'Animate UI', status: 'CONTACTED', source: 'Referral', lastActivity: '7h ago' },
    { id: '6', name: 'Sahaj', company: 'Tweakcn', status: 'LEAD', source: 'Website', lastActivity: '8h ago' },
    { id: '7', name: 'Arham Khan', company: 'Weblabs Studio', status: 'WON', source: 'Website', lastActivity: '1d ago' },
    { id: '8', name: 'Sarah Drasner', company: 'Netlify', status: 'ACTIVE', source: 'Referral', lastActivity: '1d ago' },
    { id: '9', name: 'Brian Lovin', company: 'GitHub', status: 'LEAD', source: 'Social Media', lastActivity: '2d ago' },
    { id: '10', name: 'Adam Wathan', company: 'Tailwind Labs', status: 'WON', source: 'Website', lastActivity: '2d ago' },
    { id: '11', name: 'Steve Schoger', company: 'Tailwind Labs', status: 'ACTIVE', source: 'Referral', lastActivity: '3d ago' },
    { id: '12', name: 'Dan Abramov', company: 'Meta', status: 'CONTACTED', source: 'Conference', lastActivity: '3d ago' },
    { id: '13', name: 'Evan You', company: 'Vue.js', status: 'ACTIVE', source: 'Website', lastActivity: '4d ago' },
    { id: '14', name: 'Rich Harris', company: 'Vercel', status: 'LEAD', source: 'Social Media', lastActivity: '5d ago' },
    { id: '15', name: 'Cassidy Williams', company: 'Netlify', status: 'WON', source: 'Referral', lastActivity: '5d ago' },
  ];

  const dashboardData = [
    { title: "Total Revenue", value: "$1,250.00", badgeText: "+12.5%", isPositive: true, subtext: "Trending up this month" },
    { title: "New Customers", value: "1,234", badgeText: "-20%", isPositive: false, subtext: "Down 20% this period" },
    { title: "Active Accounts", value: "45,678", badgeText: "+12.5%", isPositive: true, subtext: "Strong user retention" },
    { title: "Growth Rate", value: "4.5%", badgeText: "+4.5%", isPositive: true, subtext: "Meets growth projections" },
  ];

  // --- HELPERS ---
  function getIcon(name, size = 5, classes = '') {
    const path = icons[name] || icons['box'];
    return `<svg viewBox="0 0 24 24" class="inline-block w-${size} h-${size} ${classes}" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="${path}" /></svg>`;
  }

  function getBadgeClasses(status) {
    const base = "inline-flex items-center px-2.5 py-0.5 rounded text-xs font-bold uppercase tracking-wide";
    const map = {
      'ACTIVE': "bg-emerald-100 text-emerald-800",
      'LEAD': "bg-amber-100 text-amber-800",
      'CONTACTED': "bg-blue-100 text-blue-800",
      'WON': "bg-purple-100 text-purple-800",
      'PENDING': "bg-yellow-100 text-yellow-800",
      'CANCELLED': "bg-red-100 text-red-800"
    };
    return `${base} ${map[status] || "bg-gray-100 text-gray-800"}`;
  }

  // --- RENDER FUNCTIONS ---
  function renderSidebar() {
    const widthClass = state.sidebarCollapsed ? 'w-20' : 'w-64';
    const justifyClass = state.sidebarCollapsed ? 'justify-center' : 'justify-between';
    const logoHTML = state.sidebarCollapsed 
      ? `` 
      : `<span class="font-extrabold text-2xl tracking-tight text-slate-900 ml-2">LAZAR</span>`;

    const navHTML = menuGroups.map(group => {
      let headerHTML = '';
      if (!state.sidebarCollapsed && group.title) {
        headerHTML = `<h4 class="px-4 mb-2 text-xs font-semibold text-slate-400 uppercase tracking-wider">${group.title}</h4>`;
      } else if (state.sidebarCollapsed && group.title) {
        headerHTML = `<div class="h-px bg-slate-100 mx-2 my-2"></div>`;
      }

      const itemsHTML = group.items.map(item => {
        const isActive = state.view === item.id;
        const bgClass = isActive && !state.sidebarCollapsed ? 'bg-blue-50' : '';
        const textClass = isActive ? 'text-blue-600' : 'text-slate-500 hover:bg-slate-50 hover:text-slate-900';
        const iconColor = isActive ? 'text-blue-600' : 'text-slate-400 group-hover:text-slate-600';
        const justifyItem = state.sidebarCollapsed ? 'justify-center h-10' : 'px-3 py-1.5';
        
        return `
          <li>
            <button onclick="setView('${item.id}')" 
              class="w-full flex items-center rounded-lg transition-all group relative ${justifyItem} ${bgClass} ${textClass}">
              ${getIcon(item.icon, 5, iconColor)}
              ${!state.sidebarCollapsed ? `<span class="ml-3 text-sm font-medium">${item.label}</span>` : ''}
            </button>
          </li>
        `;
      }).join('');

      return `<div>${headerHTML}<ul class="space-y-0.5">${itemsHTML}</ul></div>`;
    }).join('');

    return `
      <aside class="fixed lg:sticky top-0 left-0 z-30 h-screen bg-white border-r border-slate-200 transition-all duration-300 ease-in-out flex flex-col ${widthClass}">
        <!-- Header -->
        <div class="h-16 flex items-center shrink-0 px-4 ${justifyClass}">
          ${logoHTML}
          <button onclick="toggleSidebar()" class="text-slate-400 hover:text-slate-600 p-2 rounded-lg transition-colors">
            ${getIcon('sidebar', state.sidebarCollapsed ? 6 : 5)}
          </button>
        </div>

        <!-- Create Button -->
        <div class="px-4 mb-4 mt-2 shrink-0 ${state.sidebarCollapsed ? 'px-2' : ''}">
          <button class="${state.sidebarCollapsed ? 'w-10 h-10 mx-auto' : 'w-full py-2.5 gap-2'} bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg flex items-center justify-center transition-colors shadow-md shadow-blue-500/30">
            ${getIcon('plus', state.sidebarCollapsed ? 6 : 5)}
            ${!state.sidebarCollapsed ? 'Create New' : ''}
          </button>
        </div>

        <!-- Nav -->
        <nav class="flex-1 overflow-y-auto px-2 space-y-4 pb-4 custom-scrollbar">
          ${navHTML}
        </nav>

        <!-- Profile -->
        <div class="p-4 border-t border-slate-200 shrink-0">
          <button class="flex items-center w-full group outline-none ${state.sidebarCollapsed ? 'justify-center' : ''}">
            <div class="relative shrink-0">
              <div class="w-9 h-9 rounded-lg bg-gradient-to-br from-blue-500 to-indigo-600 text-white font-bold text-sm flex items-center justify-center shadow-sm">AK</div>
              <span class="absolute bottom-0 right-0 w-2.5 h-2.5 bg-emerald-500 border-2 border-white rounded-full"></span>
            </div>
            ${!state.sidebarCollapsed ? `
              <div class="ml-3 text-left flex-1 overflow-hidden">
                <p class="text-sm font-semibold text-slate-900 truncate group-hover:text-blue-600 transition-colors">Alex Knight</p>
                <p class="text-xs text-slate-500 truncate">alex@lazar.com</p>
              </div>
              ${getIcon('chevronUpDown', 4, 'text-slate-400 group-hover:text-slate-600')}
            ` : ''}
          </button>
        </div>
      </aside>
    `;
  }

  function renderHeader() {
    let dropdownHTML = '';
    if (state.breadcrumbOpen) {
       const menuHTML = menuGroups.map(group => {
         const title = group.title ? `<div class="px-3 py-1.5 text-xs font-semibold text-slate-400 uppercase tracking-wider">${group.title}</div>` : '';
         const items = group.items.map(item => {
           const isActive = state.view === item.id;
           return `
             <button onclick="selectView('${item.id}')" class="w-full text-left flex items-center gap-3 px-3 py-2 text-sm text-slate-700 hover:bg-slate-50 transition-colors relative ${isActive ? 'text-blue-600 bg-blue-50' : ''}">
               ${getIcon(item.icon, 4, isActive ? 'text-blue-600' : 'text-slate-400')}
               <span class="font-medium">${item.label}</span>
               ${isActive ? getIcon('check', 4, 'ml-auto text-blue-600') : ''}
             </button>
           `;
         }).join('');
         return `${title}${items}`;
       }).join('<div class="h-px bg-slate-100 my-1 mx-3"></div>');
       
       dropdownHTML = `
         <div class="fixed inset-0 z-10" onclick="toggleBreadcrumb()"></div>
         <div class="absolute top-full left-0 mt-2 w-64 bg-white border border-slate-200 shadow-xl rounded-xl z-20 py-2 animate-in fade-in zoom-in-95 duration-200 overflow-hidden">
            ${menuHTML}
         </div>
       `;
    }

    return `
      <header class="h-20 bg-white border-b border-slate-200 flex items-center justify-between px-8 z-10 sticky top-0">
        <div class="flex items-center gap-4">
          <div class="flex items-center gap-2 relative z-20">
             <div class="relative">
                <button onclick="toggleBreadcrumb()" class="flex items-center gap-1 cursor-pointer hover:bg-slate-50 px-2 py-1 rounded-md transition-colors -ml-2 outline-none">
                   <!-- Changed to text-xl as requested -->
                   <span class="text-xl font-bold text-slate-900 capitalize">${state.view}</span>
                   ${getIcon('chevronUpDown', 4, 'text-slate-400')}
                </button>
                ${dropdownHTML}
             </div>
             <span class="text-slate-300 text-lg">/</span>
             <span class="text-base font-normal text-slate-500">Pending</span>
          </div>
        </div>
        <div class="flex items-center gap-6">
           <div onclick="toggleSearch()" class="hidden md:flex relative group cursor-pointer">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                 ${getIcon('search', 5, 'text-slate-400')}
              </div>
              <input type="text" readonly placeholder="Search..." class="cursor-pointer pl-10 pr-12 py-2 bg-slate-50 border border-transparent hover:bg-slate-100 hover:border-slate-200 rounded-lg text-sm w-64 transition-all placeholder-slate-400 text-slate-700">
              <div class="absolute inset-y-0 right-1.5 flex items-center pointer-events-none">
                 <span class="text-[10px] font-bold text-slate-500 border border-slate-200 rounded px-1.5 py-0.5 bg-white shadow-sm tracking-wide">âŒ˜ K</span>
              </div>
           </div>
           <div class="flex items-center gap-4">
             <button class="text-slate-400 hover:text-slate-600">${getIcon('sun', 5)}</button>
             <button class="text-slate-400 hover:text-slate-600 relative">
               ${getIcon('bell', 5)}
               <span class="absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full border-2 border-white"></span>
             </button>
             <button class="w-9 h-9 rounded-lg bg-slate-100 hover:bg-slate-200 text-slate-700 font-bold text-xs flex items-center justify-center">AK</button>
           </div>
        </div>
      </header>
    `;
  }

  function renderOrdersView() {
    // Secondary Sidebar Items
    const payments = [
      { label: 'All payments', count: 89 }, { label: 'Succeeded', count: 23 }, { label: 'Refunded', count: 12 }, { label: 'Uncaptured', count: 2 }
    ];
    const customers = [
      { label: 'All customers', count: 24 }, { label: 'Top spenders', count: 45 }, { label: 'Repeat buyers', count: 12, active: true }, { label: 'Recent', count: 89 }, { label: 'Abandoned', count: 64 }
    ];

    const sidebarHTML = `
      <aside class="hidden lg:block w-64 bg-slate-50/50 border-r border-slate-200 flex-shrink-0 flex flex-col h-full">
        <div class="p-6 pb-2">
           <div class="relative group">
             <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                ${getIcon('search', 5, 'text-slate-400')}
             </div>
             <!-- Darker background bg-slate-200 as requested -->
             <input type="text" placeholder="Search Orders" class="pl-10 pr-4 py-2 bg-slate-200 border border-transparent hover:bg-slate-300/50 hover:border-slate-300 rounded-lg text-sm w-full transition-all placeholder-slate-500 text-slate-700 focus:outline-none focus:ring-0">
           </div>
        </div>
        <div class="p-6 pt-2 space-y-6">
           <div>
              <h3 class="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2">Payments</h3>
              <ul class="space-y-0.5">
                ${payments.map(item => `<li><button class="w-full flex items-center justify-between px-2 py-1.5 text-sm text-slate-600 rounded-md hover:bg-slate-100 transition-colors group"><span>${item.label}</span><span class="text-slate-400 text-xs font-medium group-hover:text-slate-600">${item.count}</span></button></li>`).join('')}
              </ul>
           </div>
           <div>
              <h3 class="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2">Customers</h3>
              <ul class="space-y-0.5">
                ${customers.map(item => `<li><button class="w-full flex items-center justify-between px-2 py-1.5 text-sm rounded-md transition-colors group ${item.active ? 'bg-slate-100 text-slate-900 font-medium' : 'text-slate-600 hover:bg-slate-100'}"><span>${item.label}</span><span class="text-slate-400 text-xs font-medium group-hover:text-slate-600">${item.count}</span></button></li>`).join('')}
              </ul>
           </div>
        </div>
      </aside>
    `;

    // Tabs
    const tabs = ['Pending', 'Completed', 'Archive'];
    const tabsHTML = tabs.map(tab => {
       const isActive = state.activeOrdersTab === tab;
       // Changed to text-lg as requested (+4px)
       return `<button onclick="setTab('${tab}')" class="pb-2 text-lg font-medium transition-all relative ${isActive ? 'text-blue-600' : 'text-slate-500 hover:text-slate-700'}">
          ${tab}
          ${isActive ? '<span class="absolute bottom-0 left-0 w-full h-0.5 bg-blue-600 rounded-t-full"></span>' : ''}
       </button>`;
    }).join('');

    // Table
    const tableRows = ordersData.map(row => `
      <tr class="hover:bg-slate-50 transition-colors group">
         <td class="px-4 py-4 whitespace-nowrap"><input type="checkbox" class="rounded border-slate-300 text-blue-600 focus:ring-blue-500 h-4 w-4"></td>
         <td class="px-6 py-4 whitespace-nowrap"><div class="text-sm font-medium text-slate-900">${row.name}</div></td>
         <td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-slate-500">${row.company}</div></td>
         <td class="px-6 py-4 whitespace-nowrap"><span class="${getBadgeClasses(row.status)}">${row.status}</span></td>
         <td class="px-6 py-4 whitespace-nowrap"><span class="inline-flex items-center px-2.5 py-0.5 rounded text-xs font-medium bg-slate-100 text-slate-600 border border-slate-200">${row.source}</span></td>
         <td class="px-6 py-4 whitespace-nowrap text-right text-sm text-slate-500">${row.lastActivity}</td>
         <td class="px-6 py-4 whitespace-nowrap text-right"><button class="text-slate-400 hover:text-slate-600 p-1 rounded-md hover:bg-slate-100 transition-colors">${getIcon('moreVertical', 4)}</button></td>
      </tr>
    `).join('');

    return `
      <div class="flex h-full relative">
        ${sidebarHTML}
        <div class="flex-1 flex flex-col min-w-0 bg-white h-full relative">
           <div class="px-8 py-6 pb-2">
              <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-4">
                 <div class="flex items-center gap-6">${tabsHTML}</div>
                 <div class="flex items-center gap-3">
                    <button class="flex items-center gap-2 px-3 py-2 bg-white border border-slate-200 rounded-lg text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all shadow-sm">Sort: Date ${getIcon('chevronDown', 3)}</button>
                    <button onclick="toggleFilterDrawer()" class="flex items-center gap-2 px-3 py-2 bg-white border border-slate-200 rounded-lg text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all shadow-sm">${getIcon('filter', 4)} Filter</button>
                    <button class="flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium transition-all shadow-sm shadow-blue-500/20">${getIcon('plus', 4)} Create</button>
                 </div>
              </div>
           </div>
           <div class="flex-1 overflow-auto px-8 pb-4">
              <div class="border border-slate-200 rounded-lg overflow-hidden">
                 <table class="min-w-full divide-y divide-slate-200">
                    <thead class="bg-slate-50">
                       <tr>
                          <th class="px-4 py-3 w-4"><input type="checkbox" class="rounded border-slate-300 text-blue-600 focus:ring-blue-500 h-4 w-4"></th>
                          <th class="px-6 py-3 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider">Name</th>
                          <th class="px-6 py-3 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider">Company</th>
                          <th class="px-6 py-3 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider">Status</th>
                          <th class="px-6 py-3 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider">Source</th>
                          <th class="px-6 py-3 text-right text-xs font-semibold text-slate-500 uppercase tracking-wider">Last Activity</th>
                          <th class="px-6 py-3 w-10"></th>
                       </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-slate-200">${tableRows}</tbody>
                 </table>
              </div>
           </div>
        </div>
        ${state.filterDrawerOpen ? renderFilterDrawer() : ''}
      </div>
    `;
  }

  function renderFilterDrawer() {
    return `
      <div class="absolute inset-0 z-50 overflow-hidden">
         <div class="absolute inset-0 bg-slate-900/20 backdrop-blur-sm transition-opacity" onclick="toggleFilterDrawer()"></div>
         <div class="absolute inset-y-0 right-0 max-w-sm w-full bg-white shadow-2xl border-l border-slate-200 transform transition-transform animate-slide-in-right flex flex-col">
            <div class="px-6 py-4 border-b border-slate-100 flex items-center justify-between">
               <h2 class="text-lg font-bold text-slate-900">Filters</h2>
               <button onclick="toggleFilterDrawer()" class="text-slate-400 hover:text-slate-600"><svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg></button>
            </div>
            <div class="flex-1 overflow-y-auto p-6 space-y-6">
               <div>
                  <label class="block text-sm font-medium text-slate-700 mb-2">Status</label>
                  <div class="space-y-2">
                     <label class="flex items-center gap-2"><input type="checkbox" class="rounded border-slate-300 text-blue-600 focus:ring-blue-500"><span class="text-sm text-slate-600">Active</span></label>
                     <label class="flex items-center gap-2"><input type="checkbox" class="rounded border-slate-300 text-blue-600 focus:ring-blue-500"><span class="text-sm text-slate-600">Pending</span></label>
                     <label class="flex items-center gap-2"><input type="checkbox" class="rounded border-slate-300 text-blue-600 focus:ring-blue-500"><span class="text-sm text-slate-600">Won</span></label>
                  </div>
               </div>
               <div>
                  <label class="block text-sm font-medium text-slate-700 mb-2">Source</label>
                  <select class="block w-full rounded-md border-slate-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border">
                     <option>All Sources</option><option>Website</option><option>Referral</option><option>Conference</option>
                  </select>
               </div>
            </div>
            <div class="p-6 border-t border-slate-100 bg-slate-50">
               <div class="flex gap-3">
                  <button class="flex-1 px-4 py-2 border border-slate-300 rounded-lg text-sm font-medium text-slate-700 hover:bg-white transition-colors" onclick="toggleFilterDrawer()">Reset</button>
                  <button class="flex-1 px-4 py-2 bg-blue-600 rounded-lg text-sm font-medium text-white hover:bg-blue-700 transition-colors" onclick="toggleFilterDrawer()">Apply</button>
               </div>
            </div>
         </div>
      </div>
    `;
  }

  function renderDashboardView() {
    const kpiHTML = dashboardData.map(d => `
       <div class="bg-white rounded-xl border border-slate-200 p-5 shadow-sm hover:shadow-md transition-all h-full flex flex-col justify-between">
          <div class="flex items-start justify-between mb-2">
             <h3 class="text-sm font-medium text-slate-500 tracking-wide">${d.title}</h3>
             <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold ${d.isPositive ? 'bg-emerald-50 text-emerald-600' : 'bg-red-50 text-red-600'}">
                ${getIcon(d.isPositive ? 'trendingUp' : 'trendingDown', 3, 'mr-1')} ${d.badgeText}
             </span>
          </div>
          <div class="my-1"><h2 class="text-2xl font-bold text-slate-900 tracking-tight">${d.value}</h2></div>
          <div class="flex items-center text-xs mt-2">
             <span class="text-slate-500 font-medium flex items-center gap-1">
                ${getIcon(d.isPositive ? 'trendingUp' : 'trendingDown', 3, d.isPositive ? 'text-emerald-500' : 'text-red-500')} ${d.subtext}
             </span>
          </div>
       </div>
    `).join('');

    return `
      <div class="p-8 space-y-6 animate-fade-in-up overflow-y-auto h-full">
         <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">${kpiHTML}</div>
         <div class="bg-white rounded-xl border border-slate-200 shadow-sm p-6 hover:shadow-md transition-shadow duration-300">
            <div class="flex flex-col md:flex-row justify-between md:items-start mb-6 gap-4">
               <div><h3 class="text-xl font-bold text-slate-900">Total Visitors</h3><p class="text-slate-500 text-sm mt-1">Total for the last 3 months</p></div>
               <div class="flex items-center gap-4">
                  <div class="flex bg-slate-100 p-1 rounded-lg">
                     <button class="px-3 py-1 text-xs font-medium rounded-md bg-white shadow-sm text-slate-900">3 months</button>
                     <button class="px-3 py-1 text-xs font-medium rounded-md text-slate-500 hover:text-slate-900">30 days</button>
                  </div>
               </div>
            </div>
            <div id="chart-container" class="w-full h-[300px] relative"></div>
         </div>
         <div class="bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden p-6 text-slate-400 text-center">
            Detailed Outline Table Placeholder
         </div>
      </div>
    `;
  }

  function renderSearchOverlay() {
    if (!state.searchOpen) return '';
    return `
      <div class="fixed inset-0 bg-slate-900/40 z-50 backdrop-blur-[2px] flex items-start justify-center pt-[15vh]" onclick="toggleSearch()">
         <div class="bg-white rounded-xl shadow-2xl w-full max-w-2xl overflow-hidden animate-fade-in-up border border-slate-200" onclick="event.stopPropagation()">
            <div class="p-4 border-b border-slate-100 flex items-center gap-3">
               ${getIcon('search', 6, 'text-slate-400')}
               <input type="text" placeholder="Search commands, pages, or files..." class="flex-1 bg-transparent text-lg outline-none placeholder-slate-400 text-slate-900 h-10" autofocus>
               <span class="text-xs font-semibold text-slate-400 border border-slate-200 rounded px-2 py-1">ESC</span>
            </div>
            <div class="p-2">
               <p class="px-3 py-2 text-xs font-semibold text-slate-400 uppercase">Recent</p>
               <button onclick="selectView('dashboard'); toggleSearch()" class="w-full text-left px-3 py-2 text-sm text-slate-600 hover:bg-slate-50 rounded-lg flex items-center gap-2">
                  ${getIcon('dashboard', 4)} Dashboard
               </button>
            </div>
         </div>
      </div>
    `;
  }

  // --- CHART RENDERING ---
  function renderChart() {
    const element = document.getElementById('chart-container');
    if (!element) return;
    element.innerHTML = ''; // clear

    const margin = { top: 20, right: 0, bottom: 30, left: 0 };
    const width = element.clientWidth - margin.left - margin.right;
    const height = element.clientHeight - margin.top - margin.bottom;

    if (width <= 0 || height <= 0) return;

    const svg = d3.select(element).append("svg")
      .attr("width", width + margin.left + margin.right)
      .attr("height", height + margin.top + margin.bottom)
      .append("g").attr("transform", `translate(${margin.left},${margin.top})`);

    const points = 15;
    const data = Array.from({ length: points }, (_, i) => {
      let val = 150 + Math.sin(i / 2) * 100 + Math.random() * 20;
      if (i > 5 && i < 10) val += 100; 
      return { date: new Date(2024, 3, i * 2 + 1), value: Math.max(50, val) };
    });

    const x = d3.scaleTime().domain(d3.extent(data, d => d.date)).range([0, width]);
    const y = d3.scaleLinear().domain([0, 400]).range([height, 0]);

    const defs = svg.append("defs");
    const gradient = defs.append("linearGradient").attr("id", "blue-gradient").attr("x1", "0%").attr("y1", "0%").attr("x2", "0%").attr("y2", "100%");
    gradient.append("stop").attr("offset", "0%").attr("stop-color", "#3B82F6").attr("stop-opacity", 0.4);
    gradient.append("stop").attr("offset", "100%").attr("stop-color", "#3B82F6").attr("stop-opacity", 0);

    const area = d3.area().x(d => x(d.date)).y0(height).y1(d => y(d.value)).curve(d3.curveMonotoneX);
    const line = d3.line().x(d => x(d.date)).y(d => y(d.value)).curve(d3.curveMonotoneX);

    svg.append("path").datum(data).attr("fill", "url(#blue-gradient)").attr("d", area);
    svg.append("path").datum(data).attr("fill", "none").attr("stroke", "#3B82F6").attr("stroke-width", 3).attr("d", line);

    const xAxis = d3.axisBottom(x).ticks(10).tickFormat(d3.timeFormat("%b %d")).tickSize(0).tickPadding(15);
    svg.append("g").attr("transform", `translate(0,${height})`).call(xAxis).call(g => g.select(".domain").remove()).attr("font-family", "Inter").attr("font-size", "10px").attr("color", "#94A3B8");
  }

  // --- MAIN RENDER ---
  function render() {
    const app = document.getElementById('app');
    
    // Determine content based on view
    let mainContent = '';
    if (state.view === 'dashboard') {
      mainContent = renderDashboardView();
    } else if (state.view === 'orders') {
      mainContent = renderOrdersView();
    } else {
      mainContent = `<div class="flex-1 flex items-center justify-center text-slate-400">View not implemented: ${state.view}</div>`;
    }

    // Assemble
    app.innerHTML = `
      ${renderSidebar()}
      <main class="flex-1 min-w-0 flex flex-col h-screen overflow-hidden bg-white">
         ${renderHeader()}
         <div class="flex-1 overflow-hidden flex flex-col">
            ${mainContent}
         </div>
      </main>
      ${renderSearchOverlay()}
    `;

    // Post-render Effects
    if (state.view === 'dashboard') {
      requestAnimationFrame(() => renderChart());
    }
  }

  // --- ACTIONS ---
  window.toggleSidebar = () => { state.sidebarCollapsed = !state.sidebarCollapsed; render(); };
  window.toggleSearch = () => { state.searchOpen = !state.searchOpen; render(); };
  window.toggleBreadcrumb = () => { state.breadcrumbOpen = !state.breadcrumbOpen; render(); };
  window.toggleFilterDrawer = () => { state.filterDrawerOpen = !state.filterDrawerOpen; render(); };
  window.setView = (view) => { 
    state.view = view; 
    state.breadcrumbOpen = false;
    if (window.innerWidth < 1024) state.sidebarCollapsed = true;
    render(); 
  };
  window.selectView = (view) => { window.setView(view); };
  window.setTab = (tab) => { state.activeOrdersTab = tab; render(); };

  // Init
  window.addEventListener('resize', () => {
    if (state.view === 'dashboard') renderChart();
  });
  
  // Initial Render
  render();

</script>
</body>
</html>